import 'server-only'

import { db } from '@/lib/db/drizzle'
import { jobCategories, skills } from '@/lib/db/schema'

export async function seedFreelancerData() {
  console.log('🌱 Seeding freelancer marketplace data...')

  try {
    // Seed job categories
    const categories = [
      {
        name: 'Web Development',
        slug: 'web-development',
        description: 'Websites, web apps, and web services',
        icon: '💻',
        sortOrder: 1
      },
      {
        name: 'Mobile Development',
        slug: 'mobile-development',
        description: 'iOS, Android, and cross-platform apps',
        icon: '📱',
        sortOrder: 2
      },
      {
        name: 'Design & Creative',
        slug: 'design-creative',
        description: 'Graphic design, UI/UX, branding',
        icon: '🎨',
        sortOrder: 3
      },
      {
        name: 'Writing & Translation',
        slug: 'writing-translation',
        description: 'Content, copywriting, translation',
        icon: '✍️',
        sortOrder: 4
      },
      {
        name: 'Digital Marketing',
        slug: 'digital-marketing',
        description: 'SEO, social media, advertising',
        icon: '📈',
        sortOrder: 5
      },
      {
        name: 'Video & Animation',
        slug: 'video-animation',
        description: 'Video editing, motion graphics, 3D',
        icon: '🎬',
        sortOrder: 6
      },
      {
        name: 'Music & Audio',
        slug: 'music-audio',
        description: 'Music production, audio editing, voice over',
        icon: '🎵',
        sortOrder: 7
      },
      {
        name: 'Programming & Tech',
        slug: 'programming-tech',
        description: 'Software development, DevOps, QA',
        icon: '⚙️',
        sortOrder: 8
      },
      {
        name: 'Data Science & Analytics',
        slug: 'data-science',
        description: 'Data analysis, ML, AI, visualization',
        icon: '📊',
        sortOrder: 9
      },
      {
        name: 'Business & Consulting',
        slug: 'business-consulting',
        description: 'Strategy, finance, management',
        icon: '💼',
        sortOrder: 10
      },
      {
        name: 'Blockchain & Crypto',
        slug: 'blockchain-crypto',
        description: 'Smart contracts, DeFi, NFTs, Web3',
        icon: '🔗',
        sortOrder: 11
      }
    ]

    const insertedCategories = await db
      .insert(jobCategories)
      .values(categories)
      .onConflictDoNothing()
      .returning()

    console.log(`✅ Inserted ${insertedCategories.length} job categories`)

    // Get all categories for skill assignment
    const allCategories = await db.select().from(jobCategories)
    const categoryMap = new Map(allCategories.map((c: any) => [c.slug, c.id]))

    // Seed skills
    const skillsData = [
      // Web Development
      {
        name: 'JavaScript',
        categoryId: categoryMap.get('web-development'),
        isVerifiable: true
      },
      {
        name: 'TypeScript',
        categoryId: categoryMap.get('web-development'),
        isVerifiable: true
      },
      {
        name: 'React',
        categoryId: categoryMap.get('web-development'),
        isVerifiable: true
      },
      {
        name: 'Next.js',
        categoryId: categoryMap.get('web-development'),
        isVerifiable: true
      },
      {
        name: 'Vue.js',
        categoryId: categoryMap.get('web-development'),
        isVerifiable: true
      },
      {
        name: 'Angular',
        categoryId: categoryMap.get('web-development'),
        isVerifiable: true
      },
      {
        name: 'Node.js',
        categoryId: categoryMap.get('web-development'),
        isVerifiable: true
      },
      {
        name: 'Express.js',
        categoryId: categoryMap.get('web-development'),
        isVerifiable: true
      },
      {
        name: 'HTML/CSS',
        categoryId: categoryMap.get('web-development'),
        isVerifiable: true
      },
      {
        name: 'Tailwind CSS',
        categoryId: categoryMap.get('web-development'),
        isVerifiable: true
      },

      // Mobile Development
      {
        name: 'React Native',
        categoryId: categoryMap.get('mobile-development'),
        isVerifiable: true
      },
      {
        name: 'Flutter',
        categoryId: categoryMap.get('mobile-development'),
        isVerifiable: true
      },
      {
        name: 'Swift',
        categoryId: categoryMap.get('mobile-development'),
        isVerifiable: true
      },
      {
        name: 'Kotlin',
        categoryId: categoryMap.get('mobile-development'),
        isVerifiable: true
      },
      {
        name: 'iOS Development',
        categoryId: categoryMap.get('mobile-development'),
        isVerifiable: true
      },
      {
        name: 'Android Development',
        categoryId: categoryMap.get('mobile-development'),
        isVerifiable: true
      },

      // Design
      {
        name: 'UI Design',
        categoryId: categoryMap.get('design-creative'),
        isVerifiable: false
      },
      {
        name: 'UX Design',
        categoryId: categoryMap.get('design-creative'),
        isVerifiable: false
      },
      {
        name: 'Graphic Design',
        categoryId: categoryMap.get('design-creative'),
        isVerifiable: false
      },
      {
        name: 'Logo Design',
        categoryId: categoryMap.get('design-creative'),
        isVerifiable: false
      },
      {
        name: 'Figma',
        categoryId: categoryMap.get('design-creative'),
        isVerifiable: true
      },
      {
        name: 'Adobe Photoshop',
        categoryId: categoryMap.get('design-creative'),
        isVerifiable: true
      },
      {
        name: 'Adobe Illustrator',
        categoryId: categoryMap.get('design-creative'),
        isVerifiable: true
      },

      // Writing
      {
        name: 'Content Writing',
        categoryId: categoryMap.get('writing-translation'),
        isVerifiable: false
      },
      {
        name: 'Copywriting',
        categoryId: categoryMap.get('writing-translation'),
        isVerifiable: false
      },
      {
        name: 'Technical Writing',
        categoryId: categoryMap.get('writing-translation'),
        isVerifiable: false
      },
      {
        name: 'Blog Writing',
        categoryId: categoryMap.get('writing-translation'),
        isVerifiable: false
      },
      {
        name: 'Translation',
        categoryId: categoryMap.get('writing-translation'),
        isVerifiable: false
      },

      // Marketing
      {
        name: 'SEO',
        categoryId: categoryMap.get('digital-marketing'),
        isVerifiable: true
      },
      {
        name: 'Social Media Marketing',
        categoryId: categoryMap.get('digital-marketing'),
        isVerifiable: false
      },
      {
        name: 'Google Ads',
        categoryId: categoryMap.get('digital-marketing'),
        isVerifiable: true
      },
      {
        name: 'Facebook Ads',
        categoryId: categoryMap.get('digital-marketing'),
        isVerifiable: true
      },
      {
        name: 'Email Marketing',
        categoryId: categoryMap.get('digital-marketing'),
        isVerifiable: false
      },
      {
        name: 'Content Marketing',
        categoryId: categoryMap.get('digital-marketing'),
        isVerifiable: false
      },

      // Video & Animation
      {
        name: 'Video Editing',
        categoryId: categoryMap.get('video-animation'),
        isVerifiable: false
      },
      {
        name: 'Motion Graphics',
        categoryId: categoryMap.get('video-animation'),
        isVerifiable: false
      },
      {
        name: '3D Animation',
        categoryId: categoryMap.get('video-animation'),
        isVerifiable: false
      },
      {
        name: 'After Effects',
        categoryId: categoryMap.get('video-animation'),
        isVerifiable: true
      },
      {
        name: 'Premiere Pro',
        categoryId: categoryMap.get('video-animation'),
        isVerifiable: true
      },

      // Programming
      {
        name: 'Python',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'Java',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'C++',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'C#',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'Go',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'Rust',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'PHP',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'Ruby',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'SQL',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'MongoDB',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'PostgreSQL',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'Redis',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'Docker',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'Kubernetes',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'AWS',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'Azure',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },
      {
        name: 'Google Cloud',
        categoryId: categoryMap.get('programming-tech'),
        isVerifiable: true
      },

      // Data Science
      {
        name: 'Machine Learning',
        categoryId: categoryMap.get('data-science'),
        isVerifiable: true
      },
      {
        name: 'Deep Learning',
        categoryId: categoryMap.get('data-science'),
        isVerifiable: true
      },
      {
        name: 'Data Analysis',
        categoryId: categoryMap.get('data-science'),
        isVerifiable: false
      },
      {
        name: 'Data Visualization',
        categoryId: categoryMap.get('data-science'),
        isVerifiable: false
      },
      {
        name: 'TensorFlow',
        categoryId: categoryMap.get('data-science'),
        isVerifiable: true
      },
      {
        name: 'PyTorch',
        categoryId: categoryMap.get('data-science'),
        isVerifiable: true
      },
      {
        name: 'Pandas',
        categoryId: categoryMap.get('data-science'),
        isVerifiable: true
      },
      {
        name: 'NumPy',
        categoryId: categoryMap.get('data-science'),
        isVerifiable: true
      },

      // Blockchain
      {
        name: 'Solidity',
        categoryId: categoryMap.get('blockchain-crypto'),
        isVerifiable: true
      },
      {
        name: 'Smart Contracts',
        categoryId: categoryMap.get('blockchain-crypto'),
        isVerifiable: true
      },
      {
        name: 'Web3.js',
        categoryId: categoryMap.get('blockchain-crypto'),
        isVerifiable: true
      },
      {
        name: 'Ethers.js',
        categoryId: categoryMap.get('blockchain-crypto'),
        isVerifiable: true
      },
      {
        name: 'DeFi',
        categoryId: categoryMap.get('blockchain-crypto'),
        isVerifiable: false
      },
      {
        name: 'NFT Development',
        categoryId: categoryMap.get('blockchain-crypto'),
        isVerifiable: false
      },
      {
        name: 'Hardhat',
        categoryId: categoryMap.get('blockchain-crypto'),
        isVerifiable: true
      },
      {
        name: 'Foundry',
        categoryId: categoryMap.get('blockchain-crypto'),
        isVerifiable: true
      },
      {
        name: 'IPFS',
        categoryId: categoryMap.get('blockchain-crypto'),
        isVerifiable: true
      }
    ]

    const insertedSkills = await db
      .insert(skills)
      .values(skillsData)
      .onConflictDoNothing()
      .returning()

    console.log(`✅ Inserted ${insertedSkills.length} skills`)

    return {
      categories: insertedCategories,
      skills: insertedSkills
    }
  } catch (_error) {
    console.error('Error seeding freelancer data:', error)
    throw error
  }
}
